__version__ = (1, 0, 0)

# â–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•—â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
# â–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
# â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘
# â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–‘â–‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–‘â–‘â•šâ•â•â•â–ˆâ–ˆâ•—â–‘â•šâ•â•â•â–ˆâ–ˆâ•—
# â–ˆâ–ˆâ•‘â–‘â•šâ•â•â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–‘â–‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–‘â–‘â•šâ–ˆâ–ˆâ•”â•â–‘â•šâ–ˆâ–ˆâ•”â•â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
# â•šâ•â•â–‘â–‘â–‘â–‘â–‘â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â–‘â–‘â•šâ•â•â•šâ•â•â•â•â•â•â–‘â–‘â•šâ•â•â•â•â•â–‘â–‘â–‘â–‘â•šâ•â•â–‘â–‘â–‘â•šâ•â•â–‘â–‘â•šâ•â•â•â•â•â•â–‘â•šâ•â•â•â•â•â•â–‘
#                Â© Copyright 2025
#            âœˆ https://t.me/mead0wssMods

# scope: hikka_only
# scope: hikka_min 1.3.3
# meta developer: @mead0wssMods & forked by DepositUser.t.me
# meta banner: https://x0.at/yCcx.jpg

from telethon import events
from .. import loader, utils


@loader.tds
class AutoFormatting(loader.Module):
    """ĞœĞ¾Ğ´ÑƒĞ»ÑŒ Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚ĞµĞºÑÑ‚Ğ° Ğ² <pre><code> Ñ‚ĞµĞ³Ğ¸."""
    
    strings = {"name": "AutoFormatting"}

    def __init__(self):
        self.enabled = False
        self.quotes_enabled = False
        self.language = "python"
        self.available_languages = [
            "python", "javascript", "html", "css", "bash", "json", 
            "xml", "sql", "php", "java", "cpp", "c", "go", "rust", 
            "ruby", "swift", "kotlin", "typescript", "yaml", "markdown"
        ]

    async def format_message(self, message):
        content = message.text
        if not content:
            return

        if self.quotes_enabled:
            content = f'"{content}"'

        formatted_content = f'<pre><code class="language-{self.language}">{content}</code></pre>'
        await message.edit(formatted_content, parse_mode="HTML")

    @loader.command()
    async def autoformat(self, message):
        """Ğ’ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ğ¸Ğ»Ğ¸ Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² <pre><code>."""
        self.enabled = not self.enabled
        status = "Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾" if self.enabled else "Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾"
        await utils.answer(
            message,
            f"ğŸª <b>ĞĞ²Ñ‚Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ</b> {status} Ê•Â·á´¥Â·Ê”\n"
            f"Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ ÑĞ·Ñ‹Ğº: <code>{self.language}</code>\n"
            f"ĞšĞ°Ğ²Ñ‹Ñ‡ĞºĞ¸: {'Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹' if self.quotes_enabled else 'Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹'}",
            parse_mode="HTML",
        )

    @loader.command()
    async def afquotes(self, message):
        """Ğ’ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚/Ğ²Ñ‹ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ĞºĞ°Ğ²Ñ‹Ñ‡ĞºĞ¸ (Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ Ğ°Ğ²Ñ‚Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ĞµÑ€Ğ¾Ğ¼)."""
        if not self.enabled:
            await utils.answer(
                message,
                "ğŸª <b>ĞÑˆĞ¸Ğ±ĞºĞ°!</b> Ğ¡Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ²ĞºĞ»ÑÑ‡Ğ¸Ñ‚Ğµ Ğ°Ğ²Ñ‚Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ¾Ğ¹ <code>.autoformat</code> Ê•Â·á´¥Â·Ê”",
                parse_mode="HTML",
            )
            return
        
        self.quotes_enabled = not self.quotes_enabled
        status = "Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹" if self.quotes_enabled else "Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹"
        quote_text = 'Ğ¾Ğ±Ğ¾Ñ€Ğ°Ñ‡Ğ¸Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ² "ĞºĞ°Ğ²Ñ‹Ñ‡ĞºĞ¸"' if self.quotes_enabled else 'Ğ±ĞµĞ· ĞºĞ°Ğ²Ñ‹Ñ‡ĞµĞº'
        await utils.answer(
            message,
            f"ğŸª <b>ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ĞºĞ°Ğ²Ñ‹Ñ‡ĞºĞ¸</b> {status} Ê•Â·á´¥Â·Ê”\n"
            f"Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ñ‚ĞµĞºÑÑ‚ Ğ±ÑƒĞ´ĞµÑ‚ {quote_text}",
            parse_mode="HTML",
        )

    @loader.command()
    async def aflang(self, message):
        """Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ ÑĞ·Ñ‹Ğº Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´ÑĞ²ĞµÑ‚ĞºĞ¸ ÑĞ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸ÑĞ°. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: .aflang python"""
        args = utils.get_args_raw(message)
        if not args:
            available = ", ".join(self.available_languages)
            await utils.answer(
                message,
                f"ğŸª <b>Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ ÑĞ·Ñ‹ĞºĞ¸:</b>\n<code>{available}</code>\n\n"
                f"<b>Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ ÑĞ·Ñ‹Ğº:</b> <code>{self.language}</code>\n\n"
                f"<b>Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:</b> <code>.aflang python</code>",
                parse_mode="HTML",
            )
            return

        language = args.lower()
        if language in self.available_languages:
            self.language = language
            await utils.answer(
                message,
                f"ğŸª <b>Ğ¯Ğ·Ñ‹Ğº Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½ Ğ½Ğ°:</b> <code>{self.language}</code> Ê•Â·á´¥Â·Ê”",
                parse_mode="HTML",
            )
        else:
            await utils.answer(
                message,
                f"ğŸª <b>ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ğ¹ ÑĞ·Ñ‹Ğº:</b> <code>{language}</code>\n"
                f"Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ <code>.aflang</code> Ğ±ĞµĞ· Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² Ğ´Ğ»Ñ ÑĞ¿Ğ¸ÑĞºĞ° ÑĞ·Ñ‹ĞºĞ¾Ğ²",
                parse_mode="HTML",
            )

    @loader.command()
    async def formatnow(self, message):
        """Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ² <pre><code> Ñ‚ĞµĞ³Ğ¸."""
        args = utils.get_args_raw(message)
        if not args:
            await utils.answer(
                message,
                "ğŸª <b>Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:</b> <code>.formatnow Ğ²Ğ°Ñˆ ĞºĞ¾Ğ´ Ğ·Ğ´ĞµÑÑŒ</code>",
                parse_mode="HTML",
            )
            return
        
        content = args
        if self.enabled and self.quotes_enabled:
            content = f'"{content}"'
            
        formatted_content = f'<pre><code class="language-{self.language}">{content}</code></pre>'
        await utils.answer(message, formatted_content, parse_mode="HTML")

    @loader.command()
    async def formatlang(self, message):
        """Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‚ĞµĞºÑÑ‚ Ñ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¸ĞµĞ¼ ÑĞ·Ñ‹ĞºĞ°. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: .formatlang python print("hello")"""
        args = utils.get_args_raw(message).split(" ", 1)
        if len(args) < 2:
            await utils.answer(
                message,
                "ğŸª <b>Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:</b> <code>.formatlang python Ğ²Ğ°Ñˆ ĞºĞ¾Ğ´</code>",
                parse_mode="HTML",
            )
            return
        
        language, code = args
        if language not in self.available_languages:
            await utils.answer(
                message,
                f"ğŸª <b>ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ğ¹ ÑĞ·Ñ‹Ğº:</b> <code>{language}</code>",
                parse_mode="HTML",
            )
            return
        
        content = code
        if self.enabled and self.quotes_enabled:
            content = f'"{content}"'
            
        formatted_content = f'<pre><code class="language-{language}">{content}</code></pre>'
        await utils.answer(message, formatted_content, parse_mode="HTML")

    @loader.command()
    async def formatstatus(self, message):
        """ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ°Ğ²Ñ‚Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ."""
        status = "Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾" if self.enabled else "Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾"
        quotes_status = "Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹" if self.quotes_enabled else "Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹"
        await utils.answer(
            message,
            f"ğŸª <b>ĞĞ²Ñ‚Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:</b> {status}\n"
            f"<b>ĞšĞ°Ğ²Ñ‹Ñ‡ĞºĞ¸:</b> {quotes_status}\n"
            f"<b>Ğ¯Ğ·Ñ‹Ğº:</b> <code>{self.language}</code>\n\n"
            f"<b>ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹:</b>\n"
            f"<code>.autoformat</code> - Ğ²ĞºĞ»/Ğ²Ñ‹ĞºĞ» Ğ°Ğ²Ñ‚Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ\n"
            f"<code>.afquotes</code> - Ğ²ĞºĞ»/Ğ²Ñ‹ĞºĞ» ĞºĞ°Ğ²Ñ‹Ñ‡ĞºĞ¸\n"
            f"<code>.aflang ÑĞ·Ñ‹Ğº</code> - ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞ·Ñ‹Ğº\n"
            f"<code>.formatnow Ñ‚ĞµĞºÑÑ‚</code> - Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞµĞ¹Ñ‡Ğ°Ñ\n"
            f"<code>.formatlang ÑĞ·Ñ‹Ğº Ñ‚ĞµĞºÑÑ‚</code> - Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ ÑĞ·Ñ‹ĞºĞ¾Ğ¼",
            parse_mode="HTML",
        )

    @loader.watcher(out=True)
    async def message_watcher(self, message):
        if not message.text:
            return
            
        commands = [".autoformat", ".afquotes", ".aflang", ".formatnow", ".formatlang", ".formatstatus"]
        text_lower = message.text.lower()
        
        for cmd in commands:
            if text_lower.startswith(cmd):
                return
        
        if self.enabled:
            await self.format_message(message)